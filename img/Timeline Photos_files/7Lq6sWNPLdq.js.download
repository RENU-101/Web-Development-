if (self.CavalryLogger) { CavalryLogger.start_js(["\/f8sZ"]); }

__d("MAnimation",["CSS","MLegacyDataStore","getVendorPrefixedName","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=b("getVendorPrefixedName")("animation-duration");function a(a,c,d){var e=b("MLegacyDataStore").get(a);clearTimeout(e.timerEnd);delete e.timerEnd;b("CSS").conditionClass(a,c,!1);b("CSS").conditionClass(a,"accelerate",!0);a.style[g]=d+"ms";e.timerStart=b("setTimeoutAcrossTransitions")(b("CSS").conditionClass.bind(null,a,c,!0),0);e.timerEnd=b("setTimeoutAcrossTransitions")(function(){b("CSS").conditionClass.bind(null,a,c,!1);a.style[g]="";b("CSS").conditionClass(a,"accelerate",!1);var d=b("MLegacyDataStore").get(a);clearTimeout(d.timerStart);delete d.timerStart},d)}e.exports={animate:a}}),null);
__d("MExpandablePymk",["cx","CSS","DOM","MLegacyDataStore","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h="m-add-friend";function a(a,c,d){var e=[],f=0;if(a){a=b("DOM").scry(a,"div","story-wrap");for(var g=0;g<a.length;g++){var i=b("DOM").find(a[g],"a",h);i=b("MLegacyDataStore").get(i);e.push(i.id);i=b("MLegacyDataStore").get(a[g]);i.sent&&f++}d.pymk_group_id=c}e&&(d.uw=e.join(","));f&&(d.pc=f);return e}function c(a,c,d){if(!a)return;var e=a.getElementsByClassName("_4-ck");e.length>0&&b("setTimeoutAcrossTransitions")(function(){a.style.height=""},800);var f=function(a){return function(){b("CSS").conditionClass(a,"_4-cl",!0)}},g=function(a){return function(){b("CSS").conditionClass(a,"_4-ck",!1)}},h=b("DOM").scry(a,"div","story-wrap"),i=0;for(var j=0;j<h.length;j++){var k=b("MLegacyDataStore").get(h[j]);if(k.transitionIn)b("MLegacyDataStore").set(h[j],{transitionIn:!1}),b("setTimeoutAcrossTransitions")(f(h[j]),800),b("setTimeoutAcrossTransitions")(g(h[j]),1200);else if(k.sent){var l=h[j];e.length>0&&(a.style.height=(a.offsetHeight-e.length*e[0].offsetHeight).toString()+"px");b("CSS").conditionClass(l,"_4-cn",!0);d&&(b("CSS").conditionClass(l,"_4-co",!0),b("CSS").conditionClass(l,"_4-cp",!1));b("setTimeoutAcrossTransitions")(function(){b("DOM").remove(l)},600);i++}}if(i<h.length){k=c.getNode("story-wrap");b("MLegacyDataStore").set(k,{sent:!0});d&&(b("CSS").conditionClass(k,"_4-cp",!0),b("CSS").conditionClass(k,"_4-co",!1))}}e.exports={getExtraArgs:a,animateExpansion:c}}),null);
__d("MFriendingState",[],(function(a,b,c,d,e,f){e.exports={REQUEST_SENT:"m:friending-state:request-sent",REQUEST_CANCELED:"m:friending-state:request-canceled",UNFRIENDED:"m:friending-state:unfriended"}}),null);
__d("XPymkFunnelLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/pymk/funnel_logging/",{event_ts:{type:"Int",required:!0},query_id:{type:"Int"},candidate_id:{type:"Int"},signature:{type:"Int"},loc:{type:"String",required:!0},ref:{type:"String"},action:{type:"Enum",required:!0,enumType:1}})}),null);
__d("MPymkFunnelLogger",["Event","MRequest","Stratcom","XPymkFunnelLoggingController"],(function(a,b,c,d,e,f){var g={listenToProfileClick:function(a,c,d){var e=a.getAttribute("data-pymk-id"),f=a.getAttribute("data-pymk-loc"),h=a.getAttribute("data-signature"),i=[];i.push(b("Event").listen(d,"click",function(){g.logClick(e,h,f)}));i.push(b("Event").listen(c,"click",function(){g.logClick(e,h,f)}));b("Stratcom").listen("m:page:unload",null,function(){b("Stratcom").removeCurrentListener();while(i.length)i.pop().remove()})},logImpression:function(a,b,c){g._logEvent(a,"impression",b,c)},logXOut:function(a,b,c){g._logEvent(a,"hide",b,c)},logClick:function(a,b,c){g._logEvent(a,"click",b,c)},logAdd:function(a,b,c){g._logEvent(a,"add",b,c)},_logEvent:function(a,c,d,e){a=b("XPymkFunnelLoggingController").getURIBuilder().setInt("candidate_id",a).setInt("signature",d).setInt("event_ts",Math.floor(Date.now()/1e3)).setEnum("action",c).setString("loc",e).getURI();new(b("MRequest"))(a).send()}};e.exports=g}),null);
__d("MAddFriend",["csx","cx","DOM","MAnimation","MExpandablePymk","MFriendingActionError","MFriendingState","MLegacyDataStore","MPageCache","MPageControllerPath","MPymkFunnelLogger","MRequest","MRequestTypes","MURI","Parent","Stratcom","gkx"],(function(a,b,c,d,e,f,g,h){var i="m-add-friend",j="m-cancel-request",k="m-unfriend-request",l="m-unfollow-request",m="m-follow-request",n="check",o="friends",p="add_friend_pymk_chain_placeholder",q="/a/mobile/friends/add_friend.php",r="/a/friendrequest/cancel/index.php",s="/a/friends/remove",t="/a/subscriptions/remove",u="/a/subscriptions/add",v=86,w=224,x="/find-friends/index.php",y="mobile_jewel";function z(a){a=a.querySelector(".touched_hide");a&&b("MAnimation").animate(a,"_4-ic",500)}function A(){var a=b("MPageControllerPath").getRequestPath();b("MPageCache").removeCachedPage(a);b("MPageCache").clearCachedIUIResponses(a)}function B(a){var c=a.getNode(i),d=b("MLegacyDataStore").get(c),e=a.getNode("m-add-friend-secondary"),f=b("MLegacyDataStore").get(e),g=d.pymk_group_id||"pymk_suggestions_box",h=a.getNode("id:"+g),j=document.getElementById(p);H(a);b("MLegacyDataStore").set(e,{one_click_adding:!0,one_click_cancel_event:null});A();var k={id:d.id,hf:d.hf,sc:d.sc,so:d.so,pl:d.pl,at:d.at,et:d.et,ed:d.ed,fref:d.fref};d.floc&&(k.floc=d.floc);d.frefs&&(k.frefs=d.frefs);d.el&&(k.el=d.el);var l=b("MExpandablePymk").getExtraArgs(h,g,k),m=b("DOM").find(e,"*",n),o=b("DOM").find(e,"div","m-add-friend-flyout");d=new(b("MURI"))(q);g=new(b("MURI"))(c.href).getQueryData()._ft_;g&&d.addQueryData({_ft_:g});g=new(b("MURI"))(c.href).getQueryData().__xts__;g&&d.addQueryData({__xts__:g});c=new(b("MRequest"))(d.toString()).setType(b("MRequestTypes").DEPENDENT);c.setData(k);var r=function(){b("DOM").show(m),b("MLegacyDataStore").get(e).bounce&&z(m),b("Stratcom").listen("friending_state_change",null,C.bind(a,k.id,b("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR)),b("Stratcom").invoke(b("MFriendingState").REQUEST_SENT,null,{event:a,userid:k.id})};c.listen("start",function(){b("MLegacyDataStore").set(e,{outgoing_request_pending:!0}),b("DOM").hide(o),r()});c.listen("postprocess",function(c){b("MLegacyDataStore").set(e,{outgoing_request_pending:!1}),f.one_click_adding&&(b("MLegacyDataStore").set(e,{one_click_adding:!1}),f.one_click_cancel_event&&E(f.one_click_cancel_event)),l&&b("MExpandablePymk").animateExpansion(h,a,j)});c.send();a.kill()}function C(a,c,d){d=d.getData();if(d.userid!=a)return;if(d.error!=c)return;a=this.getNode("m-add-friend-secondary");if(d.error===b("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR){b("MLegacyDataStore").set(a,{outgoing_request_pending:!1});var e=(c=b("DOM")).find(a,"*",n),f=c.find(a,"div","m-add-friend-flyout");c.show(f);c.hide(e);b("Stratcom").invoke(b("MFriendingActionError").SEND_OUTGOING_REQUEST_ERROR,null,{event:this})}else if(d.error===b("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR){f=(c=b("DOM")).find(a,"a","m-cancel-request");e=c.find(a,"div","m-add-friend-flyout");c.show(f);c.hide(e);b("Stratcom").invoke(b("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR,null,{event:this})}b("Stratcom").removeCurrentListener()}function D(a){var c=b("MLegacyDataStore").get(a.getNode(k)),d=c.flyoutEvent;A();a=d.getNode("undoable-action");a||(a=d.getNode("m-add-friend-secondary"));var e=b("DOM").scry(a,"*",o)[0],f=b("DOM").find(a,"div","m-add-friend-flyout");a=new(b("MURI"))(s);a=new(b("MRequest"))(a);a.setData({friend_id:c.id,noReload:!0,unref:c.unfriend_ref});a.listen("start",function(){b("DOM").hide(e),c.is_deactivated||b("DOM").show(f),b("Stratcom").invoke(b("MFriendingState").UNFRIENDED,null,{event:d,userid:c.id})});a.send();d.kill()}function E(a){var c=b("MLegacyDataStore").get(a.getNode(j)),d=a.getNode("undoable-action");d||(d=a.getNode("m-add-friend-secondary"));d||(d=c.parentNode);var e=b("DOM").scry(d,"*",n)[0],f=b("DOM").find(d,"*","load"),g=b("DOM").find(d,"div","m-add-friend-flyout");d=a.getNode("m-add-friend-secondary");var h=d?b("MLegacyDataStore").get(d):null;if(K&&h&&h.outgoing_request_pending)return;if(h&&h.one_click_adding){b("MLegacyDataStore").set(d,{one_click_cancel_event:a});b("DOM").hide(e);b("DOM").show(f);return}var i=function(){b("MLegacyDataStore").get(g).not_friendable||b("DOM").show(g),b("Stratcom").invoke(b("MFriendingState").REQUEST_CANCELED,null,{event:a,userid:c.id})};h=new(b("MURI"))(r);d=new(b("MRequest"))(h);d.setData({subject_id:c.id,ref_param:c.ref_param,floc:c.floc,frefs:c.frefs});b("Stratcom").listen("friending_state_change",null,C.bind(a,c.id,b("MFriendingActionError").CANCEL_OUTGOING_REQUEST_ERROR));d.listen("start",function(){b("DOM").hide(e),b("DOM").show(f)});d.listen("finally",function(){b("DOM").hide(f);i();var c=a.getNode("story-wrap");c&&b("MLegacyDataStore").set(c,{sent:!1})});d.send();a.kill()}function F(a){var c=a.getNode(l);c=b("MLegacyDataStore").get(c);var d=new(b("MURI"))(t);d=new(b("MRequest"))(d);var e=a,f=null;try{a=c.flyoutEvent,f=a.getNode("popup-action-trigger")}catch(a){f=null}if(f!==null){d.setData({subject_id:c.id,forceredirect:!1,location:v});d.send();b("MLegacyDataStore").set(f,{is_following:!1});a.kill();return}f=e.getNode("m-add-friend-flyout");var g=b("DOM").find(f,"a","m-follow-request"),h=b("DOM").find(f,"a","m-unfollow-request"),i=b("DOM").find(f,"*","load");d.setData({subject_id:c.id,forceredirect:!1,location:w});d.listen("start",function(){b("DOM").hide(h),b("DOM").show(i)});d.listen("finally",function(){b("DOM").hide(i),b("DOM").show(g)});d.send();e.kill()}function G(a){var c=a.getNode(m);c=b("MLegacyDataStore").get(c);var d=new(b("MURI"))(u);d=new(b("MRequest"))(d);var e=a,f=null;try{a=c.flyoutEvent,f=a.getNode("popup-action-trigger")}catch(a){f=null}if(f!==null){d.setData({subject_id:c.id,forceredirect:!1,location:v});d.send();b("MLegacyDataStore").set(f,{is_following:!0});a.kill();return}f=e.getNode("m-add-friend-flyout");var g=b("DOM").find(f,"a","m-follow-request"),h=b("DOM").find(f,"a","m-unfollow-request"),i=b("DOM").find(f,"*","load");d.setData({subject_id:c.id,forceredirect:!1,location:w});d.listen("start",function(){b("DOM").hide(g),b("DOM").show(i)});d.listen("finally",function(){b("DOM").hide(i),b("DOM").show(h)});d.send();e.kill()}function H(a){a=a.getNode(i);if(!a)return;a=b("Parent").bySelector(a,"._5pxa");if(!a)return;var c=a.getAttribute("data-pymk-id"),d=a.getAttribute("data-pymk-loc");if(c&&(d===x||d===y)){a=a.getAttribute("data-signature");b("MPymkFunnelLogger").logAdd(c,a,d)}}var I=!1,J=!1,K=!1;a=function(a){a!==void 0&&a&&!J&&(J=!0,b("Stratcom").listen("click",l,F),b("Stratcom").listen("click",m,G));if(I)return;I=!0;K=b("gkx")("832605");b("Stratcom").listen("click",i,B);b("Stratcom").listen("click",j,E);b("Stratcom").listen("click",k,D)};e.exports={main:a}}),null);